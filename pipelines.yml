template: true
valuesFilePath: ./values.yml

resources: 
  - name: {{ .Values.pipelines.name }}
    type: ReleaseBundle
    configuration:
      sourceDistribution: {{ .Values.distribution }}
      name: {{ .Values.pipelines.name }}
      version: beta
 
  # # Signed version of the same release bundle
  # - name: signed_bundle
  #   type: ReleaseBundle
  #   configuration:
  #     sourceDistribution: myDist
  #     name: demo_rb
  #     version: v1.0.0
 
  # # Distribution rules
  # - name: distribution_rules
  #   type: DistributionRule
  #   configuration:
  #     sourceDistribution: myDist
  #     serviceName: "*"
  #     siteName: "*"
  #     cityName: "*"
  #     countryCodes:
  #       - "JP"
  #       - "GB"


pipelines:
  - name: {{ .Values.pipelines.name }}
    steps:
      - name: create_release_bundle
        type: CreateReleaseBundle
        configuration:
          releaseBundleName: {{ .Values.pipelines.name }}
          releaseBundleVersion: beta-${run_number}
          dryRun: false
          # sign: false # default
          description: {{ .Values.pipelines.name }}
          inputResources:
            # you can reuse a build info even if a resource definition is not in this pipelines.yml
            # because this is a global resource
            - name: {{ .Values.inputBuild.name1 }}
            - name: {{ .Values.inputBuild.name2 }}
          outputResources:
            - name: {{ .Values.pipelines.name }}
          # releaseNotes:
          #   syntax: markdown
          #   content: |
          #     ## Heading
          #       * Bullet
          #       * Points
             
      # - name: sign
      #   type: SignReleaseBundle
      #   configuration:
      #     inputResources:
      #       - name: release_bundle
      #     outputResources:
      #       - name: signed_bundle
 
      # - name: distribute
      #   type: DistributeReleaseBundle
      #   configuration:
      #     dryRun: false
      #     inputResources:
      #       - name: signed_bundle
      #       - name: distribution_rules
